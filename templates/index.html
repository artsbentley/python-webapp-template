<!doctype html>
<html lang="en" data-theme="light">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>User Management</title>
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<script src="https://unpkg.com/htmx.org@1.9.10"></script>
		<link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.23/dist/full.min.css" rel="stylesheet" type="text/css" />
		<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
	</head>
	<body class="bg-gray-100 min-h-screen p-8">
		<div class="max-w-4xl mx-auto">
			<h1 class="text-3xl font-bold mb-8">User Management</h1>

			<div class="bg-white rounded-lg shadow p-6 mb-8">
				<h2 class="text-xl font-semibold mb-4">Add New User</h2>

				<div id="message-container"></div>

				<form
					id="user-form"
					hx-post="/user"
					hx-target="#users-table"
					hx-swap="innerHTML"
					hx-trigger="submit"
					hx-on::after-request="
                        if(event.detail.successful) {
                            this.reset();
                        }
                        setTimeout(() => {
                            document.querySelectorAll('.alert').forEach(alert => {
                                alert.style.display = 'none';
                            });
                        }, 3000);"
					class="space-y-4"
				>
					<div>
						<label for="name" class="block text-sm font-medium text-gray-700">Name</label>
						<input
							type="text"
							id="name"
							name="name"
							required
							class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
						/>
					</div>

					<div>
						<label for="age" class="block text-sm font-medium text-gray-700">Age</label>
						<input
							type="number"
							id="age"
							name="age"
							required
							class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
						/>
					</div>

					<div>
						<label for="email" class="block text-sm font-medium text-gray-700">Email</label>
						<input
							type="email"
							id="email"
							name="email"
							required
							class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
						/>
					</div>

					<button
						type="submit"
						class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
					>
						Add User
					</button>
				</form>
			</div>

			<!-- Users Table Section -->
			<div id="users-table" class="bg-white rounded-lg shadow overflow-hidden">
				{% block table %}
				<table class="table table-md">
					<thead class="bg-gray-50">
						<tr>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Age</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
						</tr>
					</thead>
					<tbody class="bg-white divide-y divide-gray-200">
						{% if context.error_message or context.success_message %}
						<tr>
							<td colspan="4">
								{% if context.error_message %}
								<div class="alert alert-warning">{{ context.error_message }}</div>
								{% endif %} {% if context.success_message %}
								<div class="alert alert-success">{{ context.success_message }}</div>
								{% endif %}
							</td>
						</tr>
						{% endif %} {% for user in context.users %}
						<tr>
							<td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ user.id }}</td>
							<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ user.name }}</td>
							<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ user.age }}</td>
							<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ user.email }}</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
				{% endblock %}
			</div>
		</div>
	</body>
</html>
