<!doctype html>
<html lang="en" data-theme="light">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>User Management</title>
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<script src="https://unpkg.com/htmx.org@1.9.10"></script>
		<link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.23/dist/full.min.css" rel="stylesheet" type="text/css" />
		<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
	</head>
	<body class="bg-base-200 min-h-screen p-8">
		<div class="max-w-4xl mx-auto">
			<h1 class="text-3xl font-bold mb-8">User Management</h1>

			<div class="bg-base-100 rounded-lg shadow p-6 mb-8">
				<h2 class="text-xl font-semibold mb-4">Add New User</h2>

				<div id="message-container"></div>

				<form
					id="user-form"
					hx-post="/create_user"
					hx-target="#users-table"
					hx-swap="innerHTML"
					hx-trigger="submit"
					hx-on::after-request="
                        if(event.detail.successful) {
                            this.reset();
                        }
                        setTimeout(() => {
                            document.querySelectorAll('.alert').forEach(alert => {
                                alert.style.display = 'none';
                            });
                        }, 3000);"
					class="space-y-4"
				>
					<div>
						<label for="name" class="label">
							<span class="label-text">Name</span>
						</label>
						<input type="text" id="name" name="name" required class="input input-bordered w-full" />
					</div>

					<div>
						<label for="age" class="label">
							<span class="label-text">Age</span>
						</label>
						<input type="number" id="age" name="age" required class="input input-bordered w-full" />
					</div>

					<div>
						<label for="email" class="label">
							<span class="label-text">Email</span>
						</label>
						<input type="email" id="email" name="email" required class="input input-bordered w-full" />
					</div>

					<button type="submit" class="btn btn-primary w-full">Add User</button>
				</form>
			</div>

			<!-- Users Table Section -->
			<div id="users-table" class="bg-base-100 rounded-lg shadow overflow-hidden">
				{% block table %}
					<table class="table table-auto w-full">
						<thead>
							<tr>
								<!-- <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th> -->
								<th>Name</th>
								<th>Age</th>
								<th>Email</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td colspan="4">
									{% if context.success is defined %}
										{% if context.success %}
											<div class="alert alert-success">{{ context.message }}</div>
										{% else %}
											<div class="alert alert-warning">{{ context.message }}</div>
										{% endif %}
									{% endif %}
								</td>
							</tr>
							{% for user in context.users %}
								<tr>
									<!-- <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ user.id }}</td> -->
									<td>{{ user.name }}</td>
									<td>{{ user.age }}</td>
									<td>{{ user.email }}</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				{% endblock %}
			</div>
		</div>
	</body>
</html>
